<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - Agente IA OyP {{ version }}</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Tabler Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons@1.74.0/iconfont/tabler-icons.min.css">
    
    <!-- Custom CSS -->
    <style>
        :root {
            --tblr-body-bg: #f5f7fb;
            --tblr-body-color: #2c3e50;
        }
        
        [data-bs-theme="dark"] {
            --tblr-body-bg: #1a1d21;
            --tblr-body-color: #e9ecef;
        }
        
        body {
            background-color: var(--tblr-body-bg);
            color: var(--tblr-body-color);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.5;
        }
        
        .content-section {
            display: none;
            padding: 1.5rem 0;
        }
        
        .content-section.active {
            display: block;
        }
        
        .card {
            border: 1px solid rgba(0, 0, 0, 0.125);
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            background-color: var(--bs-card-bg, #fff);
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }
        
        .card-header {
            background-color: rgba(0, 0, 0, 0.03);
            border-bottom: 1px solid rgba(0, 0, 0, 0.125);
            padding: 1rem 1.25rem;
            border-top-left-radius: 0.5rem !important;
            border-top-right-radius: 0.5rem !important;
        }
        
        .card-title {
            margin-bottom: 0;
            font-weight: 600;
        }
        
        .card-body {
            padding: 1.25rem;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            user-select: none;
            border: 1px solid transparent;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            line-height: 1.5;
            border-radius: 0.375rem;
            transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, 
                        border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        .btn-primary {
            color: #fff;
            background-color: #467fcf;
            border-color: #467fcf;
        }
        
        .btn-primary:hover {
            background-color: #3c6da9;
            border-color: #3c6da9;
        }
        
        .form-control, .form-select {
            display: block;
            width: 100%;
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #d2ddec;
            border-radius: 0.375rem;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        .form-control:focus, .form-select:focus {
            color: #495057;
            background-color: #fff;
            border-color: #a5d4f9;
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(70, 127, 207, 0.25);
        }
        
        .mb-3 {
            margin-bottom: 1rem !important;
        }
        
        .mt-4 {
            margin-top: 1.5rem !important;
        }
        
        .me-1 {
            margin-right: 0.25rem !important;
        }
        
        .ti {
            font-size: 1.2em;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Barra de navegación -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="ti ti-bolt me-2"></i>
                Agente IA OyP {{ version }}
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-section="inicio">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="analisis">Análisis</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="documentos">Documentos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="entrenamiento">Entrenamiento</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="agente">Agente</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="chat">Chat</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-section="configuracion">Configuración</a>
                    </li>
                </ul>
                <div class="d-flex
                    <span class="navbar-text me-3">
                        <i class="ti ti-circle-check text-success me-1"></i>
                        <span id="connection-status">Conectado</span>
                    </span>
                    <button class="btn btn-outline-light" id="theme-toggle">
                        <i class="ti ti-moon me-1"></i>
                        <span>Modo Oscuro</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-xl">
        <!-- Contenedor de alertas -->
        <div id="alerts-container"></div>
        
        <!-- Contenido principal -->
        <div id="main-content">
            <!-- SECCIÓN ANALYTICS SPSS -->
            <div id="analisis" class="content-section">
    <div class="card mb-4">
      <div class="card-header">
        <h3 class="card-title">Analytics SPSS - Análisis Estadístico</h3>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <div class="mb-3">
              <label for="dataset-file" class="form-label">Subir Dataset</label>
              <input type="file" id="dataset-file" class="form-control" accept=".csv,.xlsx,.json">
            </div>
          </div>
          <div class="col-md-6">
            <div class="mb-3">
              <label for="analysis-type" class="form-label">Tipo de Análisis</label>
              <select id="analysis-type" class="form-select">
                <option value="descriptive">Estadísticas Descriptivas</option>
                <option value="correlation">Análisis de Correlación</option>
                <option value="regression">Regresión Lineal</option>
                <option value="clustering">Clustering K-means</option>
                <option value="anova">ANOVA</option>
                <option value="chi_square">Chi-cuadrado</option>
              </select>
            </div>
          </div>
        </div>
        <button id="analyze-dataset-button" class="btn btn-primary">
          <i class="ti ti-chart-line me-1"></i>Analizar Dataset
        </button>
        <div id="analysis-results" class="mt-4"></div>
      </div>
    </div>
    
    <div class="row row-deck row-cards">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body">
            <h3 class="card-title">Uso de Recursos del Sistema</h3>
            <div class="chart-container">
              <canvas id="recursos-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body">
            <h3 class="card-title">Distribución de Almacenamiento</h3>
            <div class="chart-container">
              <canvas id="storage-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Otras secciones del dashboard -->
  <div id="inicio" class="content-section active">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Bienvenido al Panel de Control</h3>
      </div>
      <div class="card-body">
        <div class="alert alert-info">
          <h4 class="alert-heading">¡Bienvenido!</h4>
          <p>Seleccione una sección del menú para comenzar a utilizar las herramientas de análisis y gestión.</p>
        </div>
        
        <div class="row">
          <div class="col-md-4">
            <div class="card">
              <div class="card-body text-center">
                <i class="ti ti-chart-line text-primary" style="font-size: 2.5rem;"></i>
                <h5 class="mt-3">Análisis Estadístico</h5>
                <p class="text-muted">Realice análisis estadísticos avanzados con SPSS</p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card">
              <div class="card-body text-center">
                <i class="ti ti-file-text text-success" style="font-size: 2.5rem;"></i>
                <h5 class="mt-3">Gestión de Documentos</h5>
                <p class="text-muted">Suba y gestione sus documentos de análisis</p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card">
              <div class="card-body text-center">
                <i class="ti ti-robot text-danger" style="font-size: 2.5rem;"></i>
                <h5 class="mt-3">Entrenamiento IA</h5>
                <p class="text-muted">Entrene modelos de IA personalizados</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Otras secciones se cargarán dinámicamente -->
  <div id="documentos" class="content-section"></div>
  <div id="entrenamiento" class="content-section"></div>
  <div id="agente" class="content-section"></div>
  <div id="chat" class="content-section"></div>
  <div id="configuracion" class="content-section"></div>
  
  <!-- Pie de página -->
  <footer class="mt-5 mb-4 text-center text-muted">
    <p>Agente IA OyP v{{ version }} &copy; {{ current_year }} - Todos los derechos reservados</p>
  </footer>
</div>

<!-- Scripts de Bootstrap y dependencias -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Scripts personalizados -->
<script>
// Manejo del tema claro/oscuro
document.addEventListener('DOMContentLoaded', function() {
    // Verificar preferencia de tema guardada
    const savedTheme = localStorage.getItem('theme') || 'light';
    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    
    // Aplicar tema guardado o preferido
    if (savedTheme === 'dark' || (savedTheme === 'system' && prefersDarkScheme.matches)) {
        document.documentElement.setAttribute('data-bs-theme', 'dark');
        document.getElementById('theme-toggle').innerHTML = '<i class="ti ti-sun me-1"></i> Modo Claro';
    } else {
        document.documentElement.setAttribute('data-bs-theme', 'light');
        document.getElementById('theme-toggle').innerHTML = '<i class="ti ti-moon me-1"></i> Modo Oscuro';
    }
    
    // Manejar cambio de tema
    document.getElementById('theme-toggle').addEventListener('click', function() {
        const currentTheme = document.documentElement.getAttribute('data-bs-theme');
        if (currentTheme === 'dark') {
            document.documentElement.setAttribute('data-bs-theme', 'light');
            localStorage.setItem('theme', 'light');
            this.innerHTML = '<i class="ti ti-moon me-1"></i> Modo Oscuro';
        } else {
            document.documentElement.setAttribute('data-bs-theme', 'dark');
            localStorage.setItem('theme', 'dark');
            this.innerHTML = '<i class="ti ti-sun me-1"></i> Modo Claro';
        }
    });
    
    // Navegación entre secciones
    document.querySelectorAll('[data-section]').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetSection = this.getAttribute('data-section');
            
            // Actualizar clase activa en la navegación
            document.querySelectorAll('.nav-link').forEach(navLink => {
                navLink.classList.remove('active');
            });
            this.classList.add('active');
            
            // Mostrar sección seleccionada
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(targetSection).classList.add('active');
            
            // Actualizar título de la página
            document.title = `${this.textContent.trim()} - Agente IA OyP ${document.documentElement.dataset.version || ''}`;
            
            // Desplazamiento suave al principio de la página
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    });
    
    // Inicializar gráficos
    initializeCharts();
    
    // Mostrar sección de inicio por defecto
    document.getElementById('inicio').classList.add('active');
});

// Inicializar gráficos
function initializeCharts() {
    // Gráfico de uso de recursos
    const recursosCtx = document.getElementById('recursos-chart').getContext('2d');
    new Chart(recursosCtx, {
        type: 'line',
        data: {
            labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
            datasets: [{
                label: 'Uso de CPU (%)',
                data: [65, 59, 80, 81, 56, 55],
                borderColor: '#467fcf',
                tension: 0.1,
                fill: false
            }, {
                label: 'Uso de Memoria (%)',
                data: [28, 48, 40, 19, 86, 27],
                borderColor: '#5eba00',
                tension: 0.1,
                fill: false
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Uso de Recursos en los Últimos 6 Meses'
                }
            }
        }
    });
    
    // Gráfico de almacenamiento
    const storageCtx = document.getElementById('storage-chart').getContext('2d');
    new Chart(storageCtx, {
        type: 'doughnut',
        data: {
            labels: ['Documentos', 'Modelos', 'Temporal', 'Libre'],
            datasets: [{
                data: [300, 150, 100, 50],
                backgroundColor: [
                    '#467fcf',
                    '#5eba00',
                    '#f1c40f',
                    '#e9ecef'
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom',
                },
                title: {
                    display: true,
                    text: 'Distribución de Almacenamiento (GB)'
                }
            }
        }
    });
}

// Manejar el botón de análisis
document.getElementById('analyze-dataset-button').addEventListener('click', function() {
    const fileInput = document.getElementById('dataset-file');
    const analysisType = document.getElementById('analysis-type').value;
    
    if (!fileInput.files || fileInput.files.length === 0) {
        showAlert('Por favor, seleccione un archivo para analizar', 'warning');
        return;
    }
    
    const file = fileInput.files[0];
    const formData = new FormData();
    formData.append('file', file);
    formData.append('analysis_type', analysisType);
    
    // Mostrar indicador de carga
    const button = this;
    const originalText = button.innerHTML;
    button.disabled = true;
    button.innerHTML = '<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>Analizando...';
    
    // Simular envío de datos (reemplazar con llamada real a la API)
    setTimeout(() => {
        // Simular respuesta exitosa
        const resultsDiv = document.getElementById('analysis-results');
        resultsDiv.innerHTML = `
            <div class="alert alert-success">
                <h4>Análisis completado</h4>
                <p>Se ha procesado el archivo <strong>${file.name}</strong> con el tipo de análisis: <strong>${document.getElementById('analysis-type').options[document.getElementById('analysis-type').selectedIndex].text}</strong></p>
                <hr>
                <p class="mb-0">Resultados del análisis disponibles en la sección de reportes.</p>
            </div>
        `;
        
        // Restaurar botón
        button.disabled = false;
        button.innerHTML = originalText;
    }, 2000);
});

// Función para mostrar alertas
function showAlert(message, type = 'info') {
    const alertsContainer = document.getElementById('alerts-container');
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
    alertDiv.role = 'alert';
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
    `;
    
    alertsContainer.appendChild(alertDiv);
    
    // Eliminar la alerta después de 5 segundos
    setTimeout(() => {
        alertDiv.remove();
    }, 5000);
}

// Exportar funciones al ámbito global
window.showAlert = showAlert;
</script>
</body>
</html>
            </div>
          </div>
          <div class="col-md-6">
            <div class="mb-3">
              <label for="analysis-type" class="form-label">Tipo de Análisis</label>
              <select id="analysis-type" class="form-select">
                <option value="descriptive">Estadísticas Descriptivas</option>
                <option value="correlation">Análisis de Correlación</option>
                <option value="regression">Regresión Lineal</option>
                <option value="clustering">Clustering K-means</option>
                <option value="anova">ANOVA</option>
                <option value="chi_square">Chi-cuadrado</option>
              </select>
            </div>
          </div>
        </div>
        <button id="analyze-dataset-button" class="btn btn-primary">
          <i class="ti ti-chart-line me-1"></i>Analizar Dataset
        </button>
        <div id="analysis-results" class="mt-4"></div>
      </div>
    </div>
    
    <div class="row row-deck row-cards">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body">
            <h3 class="card-title">Uso de Recursos del Sistema</h3>
            <div class="chart-container">
              <canvas id="recursos-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body">
            <h3 class="card-title">Distribución de Almacenamiento</h3>
            <div class="chart-container">
              <canvas id="storage-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Generación de Reportes</h3>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label for="report-type" class="form-label">Tipo de Reporte</label>
          <select id="report-type" class="form-select">
            <option value="general">Reporte General</option>
            <option value="documentos">Análisis de Documentos</option>
            <option value="ia">Rendimiento de IA</option>
            <option value="recursos">Uso de Recursos</option>
            <option value="analytics">Analytics SPSS</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="report-format" class="form-label">Formato de Salida</label>
          <select id="report-format" class="form-select">
            <option value="pdf">PDF</option>
            <option value="excel">Excel</option>
            <option value="html">HTML</option>
            <option value="json">JSON</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="report-content-input" class="form-label">Contenido del Reporte</label>
          <textarea id="report-content-input" class="form-control custom-scroll" rows="10" placeholder="Escribe el contenido que deseas incluir en el reporte..."></textarea>
        </div>
        <button id="generate-report-button" class="btn btn-primary">
          <i class="ti ti-file-download me-1"></i>Generar Reporte
        </button>
        <div id="report-result-container" class="mt-4"></div>
      </div>
    </div>
  </div>

  <!-- SECCIÓN SERVICIOS -->
  <div id="servicios" class="content-section">
    <div class="row row-deck row-cards">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Estado de Microservicios</h3>
            <div class="card-actions">
              <button class="btn btn-primary" id="refresh-services">
                <i class="ti ti-refresh me-1"></i>Actualizar
              </button>
            </div>
          </div>
          <div class="card-body">
            <div id="services-grid" class="row"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECCIÓN CONFIGURACIÓN -->
  <div id="configuracion" class="content-section">
    <div class="row g-3">
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Depuración y Mocks</h3>
          </div>
          <div class="card-body">
            <div class="mb-2">Activar Mocks cuando el backend no responda o para pruebas locales.</div>
            <div class="form-check form-switch mb-3">
              <input class="form-check-input" type="checkbox" id="toggle-mocks" checked>
              <label class="form-check-label" for="toggle-mocks">Usar datos Mock</label>
            </div>
            <div class="d-flex gap-2 flex-wrap">
              <button id="btn-mock-dashboard" class="btn btn-outline-primary">
                <i class="ti ti-refresh me-1"></i>Cargar Dashboard (Mock)
              </button>
              <button id="btn-run-tests" class="btn btn-outline-secondary">
                <i class="ti ti-test-pipe me-1"></i>Ejecutar Tests
              </button>
              <button id="btn-clear-cache" class="btn btn-outline-warning">
                <i class="ti ti-trash me-1"></i>Limpiar Caché
              </button>
            </div>
            <div id="test-results" class="mt-3"></div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Configuración de API</h3>
          </div>
          <div class="card-body form-enhanced">
            <div class="mb-3">
              <label for="api-timeout" class="form-label">Timeout API (segundos)</label>
              <input type="number" id="api-timeout" class="form-control" value="10" min="5" max="60">
            </div>
            <div class="mb-3">
              <label for="retry-attempts" class="form-label">Intentos de reintento</label>
              <input type="number" id="retry-attempts" class="form-control" value="3" min="1" max="10">
            </div>
            <div class="mb-3">
              <label for="websocket-url" class="form-label">URL WebSocket</label>
              <input type="text" id="websocket-url" class="form-control" value="ws://localhost:8080/ws">
            </div>
            <div class="mb-3">
              <label for="api-key-openai" class="form-label">OpenAI API Key</label>
              <input type="password" id="api-key-openai" class="form-control" placeholder="sk-...">
            </div>
            <div class="mb-3">
              <label for="api-key-anthropic" class="form-label">Anthropic API Key</label>
              <input type="password" id="api-key-anthropic" class="form-control" placeholder="ant-...">
            </div>
            <button id="save-config" class="btn btn-success">
              <i class="ti ti-device-floppy me-1"></i>Guardar Configuración
            </button>
          </div>
        </div>
      </div>
      
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Configuración Avanzada del Sistema</h3>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-4">
                <div class="card card-sm">
                  <div class="card-body">
                    <h5 class="card-title">Modelos IA Locales</h5>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-llama" checked>
                      <label class="form-check-label" for="enable-llama">Llama 3.1 8B</label>
                    </div>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-mistral">
                      <label class="form-check-label" for="enable-mistral">Mistral 7B</label>
                    </div>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-deepseek">
                      <label class="form-check-label" for="enable-deepseek">DeepSeek R1</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card card-sm">
                  <div class="card-body">
                    <h5 class="card-title">Servicios Cloud</h5>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-openai">
                      <label class="form-check-label" for="enable-openai">OpenAI GPT-4</label>
                    </div>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-anthropic">
                      <label class="form-check-label" for="enable-anthropic">Anthropic Claude</label>
                    </div>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-google">
                      <label class="form-check-label" for="enable-google">Google Gemini</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card card-sm">
                  <div class="card-body">
                    <h5 class="card-title">Funcionalidades</h5>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-training" checked>
                      <label class="form-check-label" for="enable-training">Entrenamiento IA</label>
                    </div>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-agent" checked>
                      <label class="form-check-label" for="enable-agent">Agente Accionable</label>
                    </div>
                    <div class="form-check form-switch mb-2">
                      <input class="form-check-input" type="checkbox" id="enable-analytics" checked>
                      <label class="form-check-label" for="enable-analytics">Analytics SPSS</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="row mt-4">
              <div class="col-md-6">
                <h5>Configuración de Rendimiento</h5>
                <div class="mb-3">
                  <label for="max-concurrent-requests" class="form-label">Requests Concurrentes Máximos</label>
                  <input type="number" id="max-concurrent-requests" class="form-control" value="10" min="1" max="100">
                </div>
                <div class="mb-3">
                  <label for="cache-size" class="form-label">Tamaño Caché (MB)</label>
                  <input type="number" id="cache-size" class="form-control" value="512" min="64" max="2048">
                </div>
                <div class="mb-3">
                  <label for="log-level" class="form-label">Nivel de Logging</label>
                  <select id="log-level" class="form-select">
                    <option value="DEBUG">DEBUG</option>
                    <option value="INFO" selected>INFO</option>
                    <option value="WARNING">WARNING</option>
                    <option value="ERROR">ERROR</option>
                  </select>
                </div>
              </div>
              <div class="col-md-6">
                <h5>Estado del Sistema</h5>
                <div class="mb-3">
                  <label class="form-label">Uso de CPU</label>
                  <div class="progress progress-enhanced mb-2">
                    <div class="progress-bar" id="cpu-usage-bar" style="width: 45%">45%</div>
                  </div>
                </div>
                <div class="mb-3">
                  <label class="form-label">Uso de Memoria</label>
                  <div class="progress progress-enhanced mb-2">
                    <div class="progress-bar bg-success" id="memory-usage-bar" style="width: 67%">67%</div>
                  </div>
                </div>
                <div class="mb-3">
                  <label class="form-label">Espacio en Disco</label>
                  <div class="progress progress-enhanced mb-2">
                    <div class="progress-bar bg-warning" id="disk-usage-bar" style="width: 34%">34%</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-4 pt-3 border-top">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-1">Información del Sistema</h6>
                  <small class="text-muted">
                    Versión: 6.0.0 | 
                    Uptime: <span id="system-uptime">--</span> | 
                    Última actualización: <span id="last-update">--</span>
                  </small>
                </div>
                <div class="btn-list">
                  <button class="btn btn-outline-danger" id="restart-system">
                    <i class="ti ti-refresh me-1"></i>Reiniciar Sistema
                  </button>
                  <button class="btn btn-outline-secondary" id="export-config">
                    <i class="ti ti-download me-1"></i>Exportar Configuración
                  </button>
                  <button class="btn btn-outline-primary" id="import-config">
                    <i class="ti ti-upload me-1"></i>Importar Configuración
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
</div>
</div>
</div>

<!-- Scripts Base -->
<script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.4.0/dist/js/tabler.min.js"></script>

<!-- Configuración Base JavaScript -->
<script>
'use strict';

// Configuración Global
window.AgenteIA = {
version: '6.0.0',
config: {
API_BASE: window.location.origin,
WS_URL: `${window.location.protocol === 'https:' ? 'wss:' : 'ws:'}//${window.location.host}/ws`,
USE_MOCKS: localStorage.getItem('USE_MOCKS') !== '0',
API_TIMEOUT: parseInt(localStorage.getItem('API_TIMEOUT')) || 10000,
RETRY_ATTEMPTS: parseInt(localStorage.getItem('RETRY_ATTEMPTS')) || 3,
DEBUG: false
},
state: {
currentSection: 'inicio',
websocketConnected: false,
trainingInProgress: false,
agentStats: { actionsCount: 0, successCount: 0, lastAction: 'Ninguna' },
chartInstances: {},
connectionManager: null
}
};

// Inicialización Base
document.addEventListener('DOMContentLoaded', function() {
console.log('🚀 Inicializando Agente IA OyP 6.0...');

// Configurar navegación básica
setupBasicNavigation();

// Configurar theme switcher
setupThemeSwitcher();

// Mostrar sección inicial
showSection('inicio');

console.log('✅ Dashboard HTML cargado - Esperando scripts funcionales...');
});

// Navegación Básica
function setupBasicNavigation() {
document.querySelectorAll('[data-target]').forEach(link => {
link.addEventListener('click', (e) => {
e.preventDefault();
const target = link.getAttribute('data-target');
showSection(target);

// Actualizar navegación activa
document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
link.classList.add('active');

// Actualizar título
const title = link.querySelector('.nav-link-title')?.textContent || target;
document.getElementById('page-title').textContent = title;
});
});

// Quick actions
document.querySelectorAll('[data-go]').forEach(link => {
link.addEventListener('click', (e) => {
e.preventDefault();
const target = link.getAttribute('data-go');
showSection(target);
});
});
}

// Theme Switcher
function setupThemeSwitcher() {
    // Configurar botones de cambio de tema
    document.querySelectorAll('[data-theme]').forEach(button => {
        button.addEventListener('click', (e) => {
            e.preventDefault();
            const theme = button.getAttribute('data-theme');
            setTheme(theme);
            updateThemeUI(theme);
        });
    });

    // Configurar botón de alternancia de tema
    const themeToggle = document.getElementById('theme-toggle');
    if (themeToggle) {
        themeToggle.addEventListener('click', (e) => {
            e.preventDefault();
            const currentTheme = localStorage.getItem('theme') || 'system';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            setTheme(newTheme);
            updateThemeUI(newTheme);
        });
    }

    // Aplicar tema guardado o detectar preferencia del sistema
    let savedTheme = localStorage.getItem('theme');
    
    // Si no hay tema guardado, usar la preferencia del sistema
    if (!savedTheme) {
        savedTheme = 'system';
        localStorage.setItem('theme', 'system');
    }
    
    setTheme(savedTheme);
    updateThemeUI(savedTheme);
}

// Actualizar la interfaz de usuario según el tema
function updateThemeUI(theme) {
    console.log('Actualizando tema a:', theme);
    
    // Obtener el tema actual (teniendo en cuenta la preferencia del sistema si es necesario)
    let currentTheme = theme;
    if (theme === 'system') {
        currentTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        console.log('Tema del sistema detectado:', currentTheme);
    }
    
    // Actualizar el ícono y texto del botón de alternancia
    const themeIcon = document.getElementById('theme-icon');
    const themeText = document.getElementById('theme-text');
    
    if (themeIcon) {
        themeIcon.className = currentTheme === 'dark' ? 'ti ti-sun' : 'ti ti-moon';
    }
    
    if (themeText) {
        themeText.textContent = currentTheme === 'dark' ? 'Modo Claro' : 'Modo Oscuro';
    }
    
    // Actualizar el selector de tema en el menú desplegable
    document.querySelectorAll('[data-theme]').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-theme') === theme) {
            btn.classList.add('active');
        }
    });
    
    // Forzar actualización de estilos
    document.documentElement.style.colorScheme = currentTheme;
    
    console.log('Tema actualizado correctamente a:', currentTheme);
}

// Escuchar cambios en la preferencia del sistema
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
    const currentTheme = localStorage.getItem('theme') || 'system';
    if (currentTheme === 'system') {
        console.log('La preferencia del sistema ha cambiado, actualizando tema...');
        setTheme('system');
        updateThemeUI('system');
    }
});

function setTheme(theme) {
const html = document.documentElement;

if (theme === 'system') {
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
html.setAttribute('data-bs-theme', prefersDark ? 'dark' : 'light');
} else {
html.setAttribute('data-bs-theme', theme);
}

localStorage.setItem('theme', theme);
}

// Mostrar Sección
function showSection(sectionId) {
// Ocultar todas las secciones
document.querySelectorAll('.content-section').forEach(section => {
section.classList.remove('active');
});

// Mostrar sección seleccionada
const targetSection = document.getElementById(sectionId);
if (targetSection) {
targetSection.classList.add('active');
window.AgenteIA.state.currentSection = sectionId;

// Trigger evento personalizado para scripts funcionales
document.dispatchEvent(new CustomEvent('sectionChanged', { detail: { section: sectionId } }));
}
}

// Utilidades básicas
function showBasicAlert(message, type = 'info') {
const container = document.getElementById('alerts-container');
if (!container) return;

const alertDiv = document.createElement('div');
alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
alertDiv.innerHTML = `
${message}
<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
`;

container.appendChild(alertDiv);

// Auto-remove después de 5 segundos
setTimeout(() => {
if (alertDiv.parentNode) {
alertDiv.remove();
}
}, 5000);
}

// Configuración de elementos básicos
document.addEventListener('DOMContentLoaded', function() {
// WebSocket status indicator básico
const wsIndicator = document.getElementById('ws-indicator');
if (wsIndicator) {
wsIndicator.className = 'ws-status';
wsIndicator.title = 'WebSocket Desconectado - Esperando scripts funcionales';
}

// Configurar botones básicos
const refreshBtn = document.getElementById('refresh-data-btn');
if (refreshBtn) {
refreshBtn.addEventListener('click', () => {
showBasicAlert('Función de actualización disponible cuando se carguen los scripts funcionales', 'info');
});
}
});

// Placeholder para scripts funcionales
console.log('📋 HTML Dashboard Base v6.0 - Estructura completa cargada');
console.log('⏳ Esperando carga de scripts funcionales (core.js, interactions.js, app.js)');
console.log('🔧 Total elementos configurados:', {
sections: document.querySelectorAll('.content-section').length,
navLinks: document.querySelectorAll('[data-target]').length,
forms: document.querySelectorAll('form, input, select, textarea').length,
buttons: document.querySelectorAll('button').length
});

</script>

</body>
</html><!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<meta http-equiv="X-UA-Compatible" content="ie=edge"/>
<title>Dashboard - Agente IA OyP 6.0</title>

<!-- Tabler 1.4 Framework -->
<link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.4.0/dist/css/tabler.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.4.0/dist/css/tabler-vendors.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@2.47.0/tabler-icons.min.css" rel="stylesheet"/>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root { 
--tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif; 
--primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
--success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
--warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
--info-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

/* Layout Base */
.page-wrapper { display: flex; flex-direction: column; min-height: 100vh; }
.page-body { flex-grow: 1; }

/* Secciones de Contenido */
.content-section { display: none; animation: fadeIn 0.35s ease; }
.content-section.active { display: block; }

@keyframes fadeIn { 
from { opacity: 0; transform: translateY(6px); } 
to { opacity: 1; transform: translateY(0); } 
}

/* Zona de Carga de Archivos */
#drop-zone { 
border: 2px dashed var(--tblr-border-color); 
border-radius: 14px; 
padding: 40px; 
text-align: center; 
cursor: pointer; 
transition: all 0.25s ease; 
background: rgba(0,0,0,.02); 
}
#drop-zone.dragover { 
background: rgba(70,127,207,.08); 
border-color: #467fcf; 
transform: scale(1.02);
}
#drop-zone:hover {
border-color: #467fcf;
background: rgba(70,127,207,.04);
}

/* KPI Cards */
.kpi-card { 
position: relative; 
overflow: hidden; 
border: 1px solid var(--tblr-border-color); 
transition: all 0.3s ease; 
background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
}
.kpi-card:hover { 
transform: translateY(-4px); 
box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
}
.kpi-card::after { 
content: ""; 
position: absolute; 
inset: -20%; 
background: radial-gradient(60% 60% at 80% -10%, rgba(70,127,207,.15), transparent 70%); 
pointer-events: none; 
}
.kpi-icon { 
width: 44px; 
height: 44px; 
display: inline-grid; 
place-items: center; 
border-radius: 12px; 
background: rgba(70,127,207,.08); 
transition: all 0.3s ease;
}
.kpi-card:hover .kpi-icon {
background: rgba(70,127,207,.15);
transform: scale(1.1);
}

/* Glass Effect */
.glass { 
backdrop-filter: saturate(1.2) blur(8px); 
background: rgba(255,255,255,.6); 
border: 1px solid var(--tblr-border-color); 
}
[data-bs-theme="dark"] .glass { background: rgba(0,0,0,.25); }

/* Quick Actions */
.quick-actions .btn { 
border-radius: 999px; 
margin: 0 4px 8px 0; 
transition: all 0.3s ease;
}
.quick-actions .btn:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* Training Pipeline Styles */
.training-step { 
border: 2px solid #dee2e6; 
border-radius: 12px; 
padding: 24px; 
margin-bottom: 20px; 
position: relative; 
transition: all 0.4s ease; 
background: linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,249,250,0.9) 100%);
}
.training-step.active { 
border-color: #467fcf; 
background: linear-gradient(135deg, rgba(70,127,207,0.1) 0%, rgba(70,127,207,0.05) 100%);
box-shadow: 0 8px 25px rgba(70,127,207,0.2);
}
.training-step.completed { 
border-color: #28a745; 
background: linear-gradient(135deg, rgba(40,167,69,0.1) 0%, rgba(40,167,69,0.05) 100%);
}
.training-step.error { 
border-color: #dc3545; 
background: linear-gradient(135deg, rgba(220,53,69,0.1) 0%, rgba(220,53,69,0.05) 100%);
}

.step-number { 
position: absolute; 
top: -12px; 
left: 24px; 
background: white; 
padding: 4px 12px; 
font-weight: bold; 
color: #467fcf; 
border-radius: 20px;
border: 2px solid #467fcf;
font-size: 14px;
}

/* Model Cards */
.model-card { 
border: 1px solid #dee2e6; 
border-radius: 12px; 
padding: 16px; 
margin-bottom: 12px; 
cursor: pointer; 
transition: all 0.3s ease; 
background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,249,250,0.8) 100%);
}
.model-card:hover { 
border-color: #467fcf; 
box-shadow: 0 4px 15px rgba(70,127,207,0.2);
transform: translateY(-2px);
}
.model-card.selected { 
border-color: #467fcf; 
background: linear-gradient(135deg, rgba(70,127,207,0.1) 0%, rgba(70,127,207,0.05) 100%);
}

/* Agent Command Interface */
.agent-command { 
background: var(--primary-gradient);
border-radius: 16px; 
padding: 24px; 
color: white; 
margin-bottom: 24px; 
position: relative;
overflow: hidden;
}
.agent-command .command-input { 
background: rgba(255,255,255,0.15); 
border: 1px solid rgba(255,255,255,0.25); 
color: white; 
border-radius: 12px; 
backdrop-filter: blur(10px);
}
.agent-command .command-input::placeholder { color: rgba(255,255,255,0.7); }

/* Chat Messages */
.chat-message { 
margin-bottom: 12px; 
padding: 10px 14px; 
border-radius: 16px; 
max-width: 85%; 
animation: slideIn 0.3s ease;
}
.chat-message.user { 
background: var(--primary-gradient);
color: white; 
margin-left: auto; 
border-bottom-right-radius: 4px;
}
.chat-message.ai { 
background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
border: 1px solid #dee2e6; 
border-bottom-left-radius: 4px;
}
.chat-message.system { 
background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
border: 1px solid #ffeaa7; 
color: #856404; 
margin: 0 auto;
max-width: 70%;
text-align: center;
}

/* Status Indicators */
.ws-status { 
display: inline-block; 
width: 8px; 
height: 8px; 
border-radius: 50%; 
background: #dc3545; 
margin-right: 6px; 
animation: pulse 2s infinite; 
}
.ws-status.connected { background: #28a745; }
.ws-status.connecting { background: #ffc107; }

@keyframes pulse {
0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
}

/* Test Badges */
.test-badge { 
display: inline-block; 
padding: 4px 10px; 
border-radius: 999px; 
font-size: 12px; 
font-weight: 500;
margin: 2px;
}
.test-badge.pass { 
background: linear-gradient(135deg, #d3f9d8 0%, #c3f7ca 100%);
color: #2b8a3e; 
}
.test-badge.fail { 
background: linear-gradient(135deg, #ffe3e3 0%, #ffc9c9 100%);
color: #c92a2a; 
}

/* Responsive Design */
@media (max-width: 768px) {
.quick-actions .btn { font-size: 0.875rem; padding: 0.375rem 0.75rem; }
.kpi-card .h1 { font-size: 1.75rem; }
.agent-command { padding: 16px; }
.training-step { padding: 16px; }
.chat-message { max-width: 90%; }
}

@media (max-width: 576px) {
.container-xl { padding: 0 12px; }
.kpi-card .h1 { font-size: 1.5rem; }
}
</style>
</head>

<body>
<div class="page">
<!-- Sidebar -->
<aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
<div class="container-fluid">
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu">
  <span class="navbar-toggler-icon"></span>
</button>
<h1 class="navbar-brand navbar-brand-autodark">
  <a href="#">
    🤖 AGENTE IA OyP 6.0
    <span class="ws-status" id="ws-indicator" title="Estado WebSocket"></span>
  </a>
</h1>
<div class="collapse navbar-collapse" id="sidebar-menu">
  <!-- Botón de cambio de tema -->
  <div class="d-flex justify-content-end mb-3 px-3">
    <button id="theme-toggle" class="btn btn-sm btn-outline-primary">
      <i class="ti ti-moon" id="theme-icon"></i> <span id="theme-text">Modo Oscuro</span>
    </button>
  </div>
  <ul class="navbar-nav pt-lg-3">
    <li class="nav-item">
      <a class="nav-link active" href="#" data-target="inicio">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-home"></i></span>
        <span class="nav-link-title">Dashboard Principal</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="documentos">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-file-text"></i></span>
        <span class="nav-link-title">Gestión de Documentos</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="ia">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-brain"></i></span>
        <span class="nav-link-title">IA (Análisis y Predicción)</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="entrenamiento">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-robot"></i></span>
        <span class="nav-link-title">Entrenamiento IA</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="agente">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-wand"></i></span>
        <span class="nav-link-title">Agente Accionable</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="chat">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-message-circle"></i></span>
        <span class="nav-link-title">Chat con IA en Tiempo Real</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="analisis">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-chart-bar"></i></span>
        <span class="nav-link-title">Analytics SPSS</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="reportes">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-report"></i></span>
        <span class="nav-link-title">Generación de Reportes</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="servicios">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-server"></i></span>
        <span class="nav-link-title">Gestión de Servicios</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#" data-target="configuracion">
        <span class="nav-link-icon d-md-none d-lg-inline-block"><i class="ti ti-settings"></i></span>
        <span class="nav-link-title">Configuración</span>
      </a>
    </li>
  </ul>
</div>
</div>
</aside>

<!-- Page Content -->
<div class="page-wrapper">
<div class="page-header d-print-none">
<div class="container-xl">
  <div class="row g-3 align-items-center">
    <div class="col">
      <div class="d-flex align-items-center gap-2">
        <h2 class="page-title mb-0" id="page-title">Dashboard Principal</h2>
        <span class="badge bg-primary-lt">v6.0</span>
        <span class="badge bg-success-lt" id="auth-status">Conectado</span>
      </div>
    </div>
    <div class="col-auto ms-auto d-print-none">
      <div class="d-flex gap-2">
        <div class="dropdown">
          <a href="#" class="btn btn-icon" data-bs-toggle="dropdown" title="Cambiar tema">
            <i class="ti ti-sun-high"></i>
          </a>
          <div class="dropdown-menu dropdown-menu-end">
            <a class="dropdown-item" href="#" data-theme="light">
              <i class="ti ti-sun me-2"></i>Claro
            </a>
            <a class="dropdown-item" href="#" data-theme="dark">
              <i class="ti ti-moon me-2"></i>Oscuro
            </a>
            <a class="dropdown-item" href="#" data-theme="system">
              <i class="ti ti-device-desktop me-2"></i>Sistema
            </a>
          </div>
        </div>
        <button class="btn btn-outline-primary" id="refresh-data-btn">
          <i class="ti ti-refresh me-1"></i>Actualizar
        </button>
        <a href="#" class="btn btn-primary" data-go="documentos">
          <i class="ti ti-plus me-1"></i> Nuevo
        </a>
      </div>
    </div>
  </div>
  <div class="row mt-3 quick-actions">
    <div class="col">
      <div class="btn-list">
        <a class="btn btn-outline-primary" href="#" data-go="documentos">
          <i class="ti ti-upload me-1"></i>Subir archivo
        </a>
        <a class="btn btn-outline-success" href="#" data-go="ia">
          <i class="ti ti-brain me-1"></i>Análisis IA
        </a>
        <a class="btn btn-outline-warning" href="#" data-go="analisis">
          <i class="ti ti-chart-line me-1"></i>Analytics SPSS
        </a>
        <a class="btn btn-outline-info" href="#" data-go="chat">
          <i class="ti ti-message-circle me-1"></i>Chat IA
        </a>
        <a class="btn btn-outline-secondary" href="#" data-go="reportes">
          <i class="ti ti-file-analytics me-1"></i>Generar reporte
        </a>
        <a class="btn btn-outline-danger" href="#" data-go="entrenamiento">
          <i class="ti ti-robot me-1"></i>Entrenar IA
        </a>
        <a class="btn btn-outline-dark" href="#" data-go="agente">
          <i class="ti ti-wand me-1"></i>Agente Accionable
        </a>
      </div>
    </div>
  </div>
</div>
</div>

<div class="page-body">
<div class="container-xl">
  <div id="alerts-container" class="mb-3"></div>

  <!-- SECCIÓN INICIO -->
  <div id="inicio" class="content-section active">
    <div class="row row-deck row-cards">
      <!-- KPIs Principales -->
      <div class="col-sm-6 col-lg-3">
        <div class="card kpi-card">
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between">
              <div class="subheader">Documentos Totales</div>
              <div class="kpi-icon"><i class="ti ti-files"></i></div>
            </div>
            <div class="h1 mb-0" id="total-documentos">Cargando...</div>
            <div class="text-muted mt-1">
              <span class="text-success">+12%</span> vs mes anterior
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="card kpi-card">
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between">
              <div class="subheader">Procesados (Semana)</div>
              <div class="kpi-icon"><i class="ti ti-calendar-stats"></i></div>
            </div>
            <div class="h1 mb-0" id="documentos-semana">Cargando...</div>
            <div class="text-muted mt-1">
              <span class="text-warning">-3%</span> vs semana anterior
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="card kpi-card">
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between">
              <div class="subheader">Precisión del Modelo IA</div>
              <div class="kpi-icon"><i class="ti ti-target"></i></div>
            </div>
            <div class="h1 mb-0" id="precision-ia">Cargando...</div>
            <div class="text-muted mt-1">
              <span class="text-success">+2.1%</span> última actualización
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="card kpi-card">
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between">
              <div class="subheader">Conexiones WebSocket</div>
              <div class="kpi-icon"><i class="ti ti-wifi"></i></div>
            </div>
            <div class="h1 mb-0" id="conexiones-ws">0</div>
            <div class="text-muted mt-1">
              <span class="text-info">Tiempo real</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Gráficos Principales -->
      <div class="col-lg-7">
        <div class="card glass">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <h3 class="card-title mb-0">Actividad de la Última Semana</h3>
              <span class="badge bg-blue-lt">7 días</span>
            </div>
            <div style="height:300px; position: relative;">
              <canvas id="actividad-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-5">
        <div class="card glass">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <h3 class="card-title mb-0">Distribución de Documentos</h3>
              <i class="ti ti-chart-donut"></i>
            </div>
            <div style="height:300px; position: relative;">
              <canvas id="distribucion-chart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Conclusiones y Estado de Servicios -->
      <div class="col-md-6">
        <div class="card glass h-100">
          <div class="card-header">
            <h3 class="card-title">Conclusiones Automáticas</h3>
          </div>
          <div class="card-body" id="conclusiones-container">
            <div class="text-center py-3">
              <div class="spinner-border spinner-border-sm text-secondary" role="status">
                <span class="visually-hidden">Cargando...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card glass h-100">
          <div class="card-header">
            <h3 class="card-title">Estado de los Servicios</h3>
          </div>
          <div class="card-body" id="servicios-container">
            <div class="text-center py-3">
              <div class="spinner-border spinner-border-sm text-secondary" role="status">
                <span class="visually-hidden">Cargando...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- SECCIÓN DOCUMENTOS -->
  <div id="documentos" class="content-section">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Cargar Nuevo Documento</h3>
      </div>
      <div class="card-body">
        <div id="drop-zone">
          <i class="ti ti-cloud-upload" style="font-size: 48px; color: #467fcf;"></i>
          <p class="mt-2 mb-1">Arrastra y suelta un archivo aquí o haz clic para seleccionar</p>
          <small class="text-muted">Formatos soportados: PDF, DOCX, TXT, imágenes</small>
          <input type="file" id="file-input" style="display: none;" accept=".pdf,.docx,.txt,.jpg,.jpeg,.png">
        </div>
        <div id="file-preview" class="mt-3"></div>
        <div class="mt-3">
          <button id="upload-button" class="btn btn-primary" style="display: none;">
            <i class="ti ti-upload me-1"></i>Subir y Procesar
          </button>
        </div>
      </div>
    </div>
    <div class="card mt-4">
      <div class="card-header">
        <h3 class="card-title">Texto Extraído</h3>
      </div>
      <div class="card-body">
        <pre id="extracted-text" class="bg-light p-3 rounded custom-scroll" style="white-space: pre-wrap; max-height: 400px; overflow-y: auto;">El resultado del procesamiento aparecerá aquí.</pre>
      </div>
    </div>
  </div>

  <!-- SECCIÓN IA -->
  <div id="ia" class="content-section">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Análisis de Texto con IA</h3>
      </div>
      <div class="card-body">
        <div class="mb-3">
          <label for="ia-text-input" class="form-label">Texto a analizar</label>
          <textarea id="ia-text-input" class="form-control" rows="6" placeholder="Pega o escribe aquí el texto que quieres que la IA analice..."></textarea>
        </div>
        <div class="mb-3">
          <label for="ia-model-select" class="form-label">Modelo de IA</label>
          <select id="ia-model-select" class="form-select">
            <option value="local">Modelo Local (Offline)</option>
            <option value="openai">OpenAI GPT-4</option>
            <option value="anthropic">Anthropic Claude</option>
            <option value="google">Google Gemini</option>
          </select>
        </div>
        <button id="ia-analyze-button" class="btn btn-primary">
          <i class="ti ti-brain me-1"></i>Analizar Texto
        </button>
        <div id="ia-result-container" class="mt-4" style="display: none;">
          <h4>Resultado del Análisis:</h4>
          <div class="card">
            <div class="card-body">
              <pre id="ia-result-text" class="mb-0 custom-scroll" style="white-space: pre-wrap;"></pre>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECCIÓN ENTRENAMIENTO IA -->
  <div id="entrenamiento" class="content-section">
    <div class="row">
      <div class="col-lg-8">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Centro de Entrenamiento IA</h3>
            <div class="card-actions">
              <button class="btn btn-primary" id="start-training-wizard">
                <i class="ti ti-plus me-1"></i>Nuevo Entrenamiento
              </button>
            </div>
          </div>
          <div class="card-body">
            <div id="training-wizard" style="display: none;">
              <div class="training-step active" id="step-1">
                <span class="step-number">1</span>
                <h4>Configuración del Proyecto</h4>
                <div class="row">
                  <div class="col-md-6">
                    <label class="form-label">Nombre del Proyecto</label>
                    <input type="text" id="project-name" class="form-control" placeholder="Ej: Análisis Contratos Empresa X">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Tipo de Entrenamiento</label>
                    <select id="training-type" class="form-select">
                      <option value="classification">Clasificación de Documentos</option>
                      <option value="extraction">Extracción de Información</option>
                      <option value="sentiment">Análisis de Sentimientos</option>
                      <option value="summarization">Resumen Automático</option>
                      <option value="custom">Personalizado</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="training-step" id="step-2">
                <span class="step-number">2</span>
                <h4>Selección de Documentos</h4>
                <div class="mb-3">
                  <label class="form-label">Carpeta de Documentos</label>
                  <select id="document-folder" class="form-select">
                    <option value="">Seleccionar carpeta...</option>
                    <option value="empresa-x">Documentos Empresa X</option>
                    <option value="contratos">Contratos Legales</option>
                    <option value="facturas">Facturas y Recibos</option>
                    <option value="informes">Informes Técnicos</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label class="form-label">Filtros de Documentos</label>
                  <div class="row">
                    <div class="col-md-4">
                      <input type="date" id="date-from" class="form-control" placeholder="Desde">
                    </div>
                    <div class="col-md-4">
                      <input type="date" id="date-to" class="form-control" placeholder="Hasta">
                    </div>
                    <div class="col-md-4">
                      <select id="document-type-filter" class="form-select">
                        <option value="">Todos los tipos</option>
                        <option value="pdf">Solo PDF</option>
                        <option value="docx">Solo DOCX</option>
                        <option value="txt">Solo TXT</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div id="document-preview" class="border rounded p-3">
                  <strong>Documentos encontrados:</strong> <span id="doc-count">0</span>
                  <div id="doc-list" class="mt-2"></div>
                </div>
              </div>

              <div class="training-step" id="step-3">
                <span class="step-number">3</span>
                <h4>Configuración del Modelo</h4>
                <div class="row">
                  <div class="col-md-6">
                    <label class="form-label">Modelo Base</label>
                    <select id="base-model" class="form-select">
                      <option value="llama-3.1-8b">Llama 3.1 8B (Local)</option>
                      <option value="mistral-7b">Mistral 7B (Local)</option>
                      <option value="deepseek-r1">DeepSeek R1 (Local)</option>
                      <option value="gpt-4">GPT-4 (Cloud)</option>
                      <option value="claude-3">Claude 3 (Cloud)</option>
                    </select>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Técnica de Entrenamiento</label>
                    <select id="training-technique" class="form-select">
                      <option value="fine-tuning">Fine-tuning Completo</option>
                      <option value="lora">LoRA (Eficiente)</option>
                      <option value="prompt-engineering">Prompt Engineering</option>
                      <option value="rag">RAG (Retrieval)</option>
                    </select>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-md-4">
                    <label class="form-label">Épocas</label>
                    <input type="number" id="epochs" class="form-control" value="3" min="1" max="20">
                  </div>
                  <div class="col-md-4">
                    <label class="form-label">Learning Rate</label>
                    <input type="number" id="learning-rate" class="form-control" value="0.0001" step="0.0001">
                  </div>
                  <div class="col-md-4">
                    <label class="form-label">Batch Size</label>
                    <input type="number" id="batch-size" class="form-control" value="8" min="1" max="32">
                  </div>
                </div>
              </div>

              <div class="training-step" id="step-4">
                <span class="step-number">4</span>
                <h4>Ejecutar Entrenamiento</h4>
                <div class="mb-3">
                  <div class="progress progress-enhanced">
                    <div id="training-progress" class="progress-bar" role="progressbar" style="width: 0%"></div>
                  </div>
                  <small class="text-muted" id="training-status">Listo para comenzar</small>
                </div>
                <div id="training-logs" class="border rounded p-3 custom-scroll" style="height: 200px; overflow-y: auto; background: #f8f9fa; font-family: monospace; font-size: 0.875rem;"></div>
              </div>

              <div class="mt-3 d-flex justify-content-between">
                <button id="prev-step" class="btn btn-outline-secondary" disabled>
                  <i class="ti ti-arrow-left me-1"></i>Anterior
                </button>
                <button id="next-step" class="btn btn-primary">
                  Siguiente<i class="ti ti-arrow-right ms-1"></i>
                </button>
                <button id="start-training" class="btn btn-success" style="display: none;">
                  <i class="ti ti-play me-1"></i>Iniciar Entrenamiento
                </button>
              </div>
            </div>

            <div id="training-projects" class="mt-4">
              <h4>Proyectos de Entrenamiento</h4>
              <div id="projects-list" class="row"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Modelos Disponibles</h3>
          </div>
          <div class="card-body">
            <div id="models-list">
              <div class="model-card" data-model="llama-3.1-8b">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <strong>Llama 3.1 8B</strong>
                    <br><small class="text-muted">Local • 8B parámetros</small>
                  </div>
                  <span class="badge bg-green-lt">Disponible</span>
                </div>
              </div>
              <div class="model-card" data-model="mistral-7b">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <strong>Mistral 7B</strong>
                    <br><small class="text-muted">Local • 7B parámetros</small>
                  </div>
                  <span class="badge bg-green-lt">Disponible</span>
                </div>
              </div>
              <div class="model-card" data-model="deepseek-r1">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <strong>DeepSeek R1</strong>
                    <br><small class="text-muted">Local • Razonamiento</small>
                  </div>
                  <span class="badge bg-yellow-lt">Descargando</span>
                </div>
              </div>
              <div class="model-card" data-model="gpt-4">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <strong>GPT-4</strong>
                    <br><small class="text-muted">Cloud • OpenAI</small>
                  </div>
                  <span class="badge bg-blue-lt">API Key Requerida</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card mt-3">
          <div class="card-header">
            <h3 class="card-title">Sistema de Feedback</h3>
          </div>
          <div class="card-body">
            <div id="feedback-queue">
              <p class="text-muted">No hay elementos pendientes de validación</p>
            </div>
            <button class="btn btn-outline-primary w-100" id="load-feedback-queue">
              <i class="ti ti-refresh me-1"></i>Cargar Cola de Feedback
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECCIÓN AGENTE ACCIONABLE -->
  <div id="agente" class="content-section">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Agente IA Accionable</h3>
        <div class="card-actions">
          <span class="badge bg-success-lt" id="agent-status">🤖 Agente Activo</span>
        </div>
      </div>
      <div class="card-body">
        <div class="agent-command">
          <h4 class="text-white mb-3">
            <i class="ti ti-wand me-2"></i>Comando de Agente
          </h4>
          <div class="input-group">
            <input type="text" id="agent-command-input" class="form-control command-input" 
                   placeholder="Ej: 'Entrena IA para empresa X con documentos de la carpeta contratos'"
                   maxlength="500">
            <button id="execute-agent-command" class="btn btn-light">
              <i class="ti ti-send me-1"></i>Ejecutar
            </button>
          </div>
          <small class="d-block mt-2 text-white-50">
            El agente ejecutará acciones reales basadas en tu comando
          </small>
        </div>

        <div class="row">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header">
                <h4 class="card-title">Historial de Acciones</h4>
              </div>
              <div class="card-body">
                <div id="agent-actions-log" class="custom-scroll" style="height: 400px; overflow-y: auto;">
                  <div class="d-flex align-items-center justify-content-center h-100 text-muted">
                    <div class="text-center">
                      <i class="ti ti-robot" style="font-size: 3rem; opacity: 0.3;"></i>
                      <p class="mt-2">El agente está esperando comandos...</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="card">
              <div class="card-header">
                <h4 class="card-title">Comandos Sugeridos</h4>
              </div>
              <div class="card-body">
                <div class="d-grid gap-2">
                  <button class="btn btn-outline-primary btn-sm" data-quick-command="entrenar-empresa-x">
                    📚 Entrenar IA para Empresa X
                  </button>
                  <button class="btn btn-outline-success btn-sm" data-quick-command="procesar-documentos-pendientes">
                    📄 Procesar documentos pendientes
                  </button>
                  <button class="btn btn-outline-warning btn-sm" data-quick-command="generar-reporte-semanal">
                    📊 Generar reporte semanal
                  </button>
                  <button class="btn btn-outline-info btn-sm" data-quick-command="validar-modelo-precision">
                    🎯 Validar precisión del modelo
                  </button>
                  <button class="btn btn-outline-secondary btn-sm" data-quick-command="limpiar-base-datos">
                    🧹 Limpiar base de datos
                  </button>
                </div>
              </div>
            </div>

            <div class="card mt-3">
              <div class="card-header">
                <h4 class="card-title">Estado del Agente</h4>
              </div>
              <div class="card-body">
                <div class="row g-2">
                  <div class="col-6">
                    <div class="card card-sm">
                      <div class="card-body p-2 text-center">
                        <div class="text-muted">Acciones</div>
                        <div class="h3 mb-0" id="agent-actions-count">0</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="card card-sm">
                      <div class="card-body p-2 text-center">
                        <div class="text-muted">Éxito</div>
                        <div class="h3 mb-0" id="agent-success-rate">0%</div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="mt-3">
                  <div class="text-muted mb-1">Última acción:</div>
                  <small id="agent-last-action">Ninguna</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECCIÓN CHAT -->
  <div id="chat" class="content-section">
    <div class="card">
      <div class="card-header">
        <div class="d-flex justify-content-between align-items-center">
          <h3 class="card-title">Chat con IA en Tiempo Real</h3>
          <span class="badge bg-green-lt" id="chat-status">WebSocket Conectado</span>
        </div>
      </div>
      <div class="card-body">
        <!-- Selector de Modelo -->
        <div class="model-selector-container mb-3">
          <div class="d-flex align-items-center">
            <label for="model-selector" class="form-label mb-0 me-2">Modelo:</label>
            <div class="dropdown">
              <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="model-selector" data-bs-toggle="dropdown" aria-expanded="false">
                <span id="selected-model">Seleccionar modelo</span>
                <span id="model-status" class="ms-2"></span>
              </button>
              <ul class="dropdown-menu" id="model-dropdown" aria-labelledby="model-selector">
                <li><div class="dropdown-header">Cargando modelos...</div></li>
              </ul>
            </div>
            <button id="configure-model-btn" class="btn btn-icon ms-2" title="Configurar modelo">
              <i class="ti ti-settings"></i>
            </button>
          </div>
        </div>
        
        <div id="chat-messages" class="mb-3 custom-scroll" style="height: 400px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 6px; padding: 15px; background: #f8f9fa;">
          <div class="chat-message system">
            <strong>Sistema:</strong> ¡Hola! Soy tu asistente de IA conectado en tiempo real. ¿En qué puedo ayudarte?
          </div>
        </div>
        <div class="input-group">
          <input type="text" id="chat-input" class="form-control" placeholder="Escribe tu mensaje..." maxlength="1000">
          <button id="chat-send-button" class="btn btn-primary">
            <i class="ti ti-send me-1"></i>Enviar
          </button>
        </div>
        <small class="form-text text-muted">Máximo 1000 caracteres por mensaje</small>
      </div>
    </div>
  </div>
</div>
</div>
</div>
</div>

<!-- Modal de Configuración de Modelo -->
<div class="modal fade" id="modelConfigModal" tabindex="-1" aria-labelledby="modelConfigModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modelConfigModalLabel">Configuración del Modelo</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="model-config-form">
          <div class="mb-3">
            <label for="model-provider" class="form-label">Proveedor</label>
            <select class="form-select" id="model-provider" disabled>
              <option value="">Selecciona un proveedor</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="api-key" class="form-label">API Key</label>
            <div class="input-group">
              <input type="password" class="form-control" id="api-key" placeholder="Ingresa tu API key">
              <button class="btn btn-outline-secondary" type="button" id="toggle-api-key">
                <i class="ti ti-eye"></i>
              </button>
            </div>
            <div class="form-text">Tu API key se guarda de forma segura en tu navegador.</div>
          </div>
          <div class="mb-3">
            <label for="model-params" class="form-label">Parámetros Avanzados</label>
            <div id="advanced-params" class="p-3 bg-light rounded">
              <div class="mb-2">
                <label for="temperature" class="form-label">Temperatura: <span id="temperature-value">0.7</span></label>
                <input type="range" class="form-range" id="temperature" min="0" max="2" step="0.1" value="0.7">
              </div>
              <div class="mb-2">
                <label for="max-tokens" class="form-label">Máx. Tokens: <span id="max-tokens-value">1000</span></label>
                <input type="range" class="form-range" id="max-tokens" min="100" max="4000" step="100" value="1000">
              </div>
            </div>
          </div>
        </div>
        <div id="model-test-result" class="alert d-none"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" id="test-model-btn">
          <span class="spinner-border spinner-border-sm d-none" id="test-spinner" role="status" aria-hidden="true"></span>
          Probar Conexión
        </button>
        <button type="button" class="btn btn-success" id="save-model-config">
          <span class="spinner-border spinner-border-sm d-none" id="save-spinner" role="status" aria-hidden="true"></span>
          Guardar Cambios
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Scripts Base -->
<script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.4.0/dist/js/tabler.min.js"></script>
<script src="{{ url_for('static', filename='js/model-manager.js') }}"></script>

</body>
</html>


